---
title: "R Notebook"
output: html_notebook
---

```{r}
# Code4.1
oldpar = par(no.readonly = TRUE)
par(mfrow = c(2,2)); par(oma = c(0,0,0,0)); par(mar = c(4,4,2,1))

# (a) Annual flow of Nile
plot(Nile, main = "(a)")

# (b) CO2
Ryori = read.csv("../tsbook-master/CO2.csv")
y_all = ts(data = Ryori$CO2, start = c(1987,1), frequency = 12)
y = window(y_all, end = c(2014, 12))
y_CO2 = y
plot(y_CO2, main = "(b)")

# (c) UK gas comsumption
plot(UKgas, main = "(c)")

# (d) artificial data generated by non-linear model
load("../tsbook-master/BenchmarkNonLinearModel.RData")
y_nonlinear = ts(y)
plot(y_nonlinear, main = "(d)")

par(oldpar)
```
```{r}
# Code4.2
oldpar = par(no.readonly = TRUE)
par(mfrow = c(2,2)); par(oma = c(0,0,0,0)); par(mar = c(4,4,2,1))

# (a) Annual flow of Nile
hist(Nile, main = "(a)", xlab = "value of data")
print(summary(Nile))

# (b) CO2
Ryori = read.csv("../tsbook-master/CO2.csv")
y_all = ts(data = Ryori$CO2, start = c(1987,1), frequency = 12)
y = window(y_all, end = c(2014, 12))
y_CO2 = y
hist(y_CO2, main = "(b)", xlab = "value of data")
print(summary(y_CO2))

# (c) UK gas comsumption
hist(UKgas, main = "(c)", xlab = "value of data")
print(summary(UKgas))

# (d) artificial data generated by non-linear model
load("../tsbook-master/BenchmarkNonLinearModel.RData")
y_nonlinear = ts(y)
hist(y_nonlinear, main = "(d)", xlab = "value of data")
print(summary(y_nonlinear))

par(oldpar)
```

```{r}
# Code4.3
library("imputeTS")

Ryori = read.csv("../tsbook-master/CO2.csv")
y_all = ts(data = Ryori$CO2, start = c(1987,1), frequency = 12)
y = window(y_all, end = c(2014, 12))
y_CO2 = y
print(summary(y_CO2))

# NA.point = which(is.na(y_CO2))
# y_CO2[NA.point] = (y_CO2[NA.point - 1] + y_CO2[NA.point + 1]) / 2

# imputeTSパッケージを使ってna.interpolation()で補間もできる
y_CO2 = na.interpolation(y_CO2, option="linear")
summary(y_CO2)
```
```{r}
# ok
mean(z <- 1:6)
print(z)

# null reference
mean(w = 1:6)
print(w)
```

